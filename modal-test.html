<head>
  <title>modal-test</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>

<body>
  <!--  There's nothing here that has any effect on our MaterializeModal use in this example. -->
  <div class="container">
    <h4>Source</h4>
    <p>
      Open a MaterializeModal with a custom template <i>and</i> a reactive data context!  All we need to do is:
      <ul>
        <li>
          Write the template we want to appear in the modal.
        </li>
        <li>
          Write the JS call logic for creating the modal.
        </li>
      </ul>
    </p>
    <div class="row">
      <div class="col s12">
        <ul class="tabs">
          <li class="tab col s6">
            <a href="#javascript" class="active">Javascript</a>
          </li>
          <li class="tab col s6">
            <a href="#html">HTML</a>
          </li>
        </ul>
      </div>
    </div>
    <div id="javascript" class="col s12">
      {{#prism language="js" class="line-numbers"}}
      //  (1) Create a reactive-var.
      //      Make sure we can access it from the console.
      window.exampleMessage = new ReactiveVar();
      //  (2) Set it to a value.
      window.exampleMessage.set("Hello world!");

      //  (3) Create a MaterializeModal.
      Template.body.rendered = function() {
        MaterializeModal.alert({ bodyTemplate: "reactiveModal", exampleMessage: window.exampleMessage });
      };

      //  (4) We just create simple .get() helpers to grab the
      //      value of any reactive-vars we passed into our
      //      MaterializeModal.
      Template.reactiveModal.helpers({
        exampleMessage: function() {
          return this.exampleMessage.get();
        }
      });
      {{/prism}}
    </div>
    <div id="html" class="col s12">
      {{#prism language="blaze" class="line-numbers"}}
        <template name="reactiveModal">
          <p>
            This is our modal's <code class="language-javascript">bodyTemplate</code>.  It can access the same data context as whatever arguments are passed into MaterializeModal.
          </p>
          <p>
            By passing reactive variables to MaterializeModal, they can be easily accessed inside your modal content helpers, as well as updated elsewhere in your code.
          </p>
          <p>
            In this example, we passed in a reactive-var named <code class="language-javascript">window.exampleMessage</code>.  Try setting its value to change the data context in this modal!  Open up the dev console and type:
          </p>
          {{#prism language="javascript"}}
            window.exampleMessage.set("Reactive data constructs are immaterial.");
          {{/prism}}
          <p>
            The value of <code class="language-javascript">window.exampleMessage</code> is currently:
          </p>
          <blockquote>
             <!-- Note: We are just using a simple Template helper here.  -->
             <code>{{|exampleMessage}}</code>
          </blockquote>
          <p>
            Close this window to see the source of this web page, or check out <a href="http://github.com/msolters/meteor-materialize-modal-test">the repo here</a>.
          </p>
        </template>
      {{/prism}}
    </div>
    <h4>Explanation</h4>
    <p>
      In <b>steps (1-2)</b>, we are just creating a simple reactive data object.  Note that this will require the reactive-var package:
    </p>
    {{#prism language="bash" class="line-numbers"}}
      meteor add reactive-var
    {{/prism}}
    <p>
      <b>Step (3)</b> is a simple example of calling a MaterializeModal with a custom template (in this case, <code class="language-javascript">reactiveModal</code>) as well as with a user-defined data context (in this case, a single reactive-var: <code class="language-javascript">window.exampleMessage</code>).  You can add as many variables into the data context as you want.
    </p>
    <p>
      Note also that we are passing the reactive-var itself (<code class="language-javascript">window.exampleMessage</code>), not its value (<code class="language-javascript">window.exampleMessage.get()</code>).  This is what allows the reactivity to extend into the template, since we are setting the data context programmatically.
    </p>
    <p>
      Finally, <b>(4)</b> shows how reactive-vars may be accessed from the template you want to embed into the modal.  Any variables passed into the MaterializeModal call will be available within the helpers using <code class="language-javascript">this.[varname].get()</code>, and they will be reactive!
    </p>
  </div>
</body>

<template name="reactiveModal">
  <p>
    This is our modal's <code class="language-javascript">bodyTemplate</code>.  It can access the same data context as whatever arguments are passed into MaterializeModal.
  </p>
  <p>
    By passing reactive variables to MaterializeModal, they can be easily accessed inside your modal content helpers, as well as updated elsewhere in your code.
  </p>
  <p>
    In this example, we passed in a reactive-var named <code class="language-javascript">window.exampleMessage</code>.  Try setting its value to change the data context in this modal!  Open up the dev console and type:
  </p>
  {{#prism language="javascript"}}
    window.exampleMessage.set("Reactive data constructs are immaterial.");
  {{/prism}}
  <p>
    The value of <code class="language-javascript">window.exampleMessage</code> is:
  </p>
  <blockquote>
     <!-- Note: We are just using a simple Template helper here.  -->
     <code>{{exampleMessage}}</code>
  </blockquote>
  <p>
    Close this window to see the source of this web page, or check out <a href="http://github.com/msolters/meteor-materialize-modal-test">the repo here</a>.
  </p>
</template>
